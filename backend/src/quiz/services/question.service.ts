import { Injectable } from '@nestjs/common';
import { QuestionDto } from '../dto/question.dto';
import * as crypto from 'crypto'; // For generating unique IDs

@Injectable()
export class QuestionService {
  private readonly allQuestions: QuestionDto[] = [
    // --- Numbers and Operations (10 questions) ---
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is the value of the digit 7 in the number 5,732?',
      options: ['7', '70', '700', '7000'],
      correctAnswer: '700',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 345 + 127?',
      options: ['462', '472', '482', '572'],
      correctAnswer: '472',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 582 - 239?',
      options: ['343', '353', '243', '357'],
      correctAnswer: '343',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 45 × 3?',
      options: ['125', '135', '145', '155'],
      correctAnswer: '135',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 84 ÷ 4?',
      options: ['19', '20', '21', '22'],
      correctAnswer: '21',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What number comes after 999?',
      options: ['100', '1000', '9999', '10000'],
      correctAnswer: '1000',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is the value of the digit 4 in 2,468?',
      options: ['4', '40', '400', '4000'],
      correctAnswer: '400',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 24 × 6?',
      options: ['124', '144', '156', '164'],
      correctAnswer: '144',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 225 ÷ 9?',
      options: ['15', '20', '25', '30'],
      correctAnswer: '25',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Numbers and Operations',
      questionText: 'What is 837 - 459?',
      options: ['378', '368', '478', '387'],
      correctAnswer: '378',
      difficulty: 'medium',
    },

    // --- Fractions and Decimals (10 questions) ---
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'Which fraction is equivalent to 1/2?',
      options: ['1/3', '2/4', '3/5', '2/3'],
      correctAnswer: '2/4',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'What is 1/4 + 2/4?',
      options: ['1/4', '2/8', '3/4', '3/8'],
      correctAnswer: '3/4',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'Express 0.5 as a fraction.',
      options: ['1/2', '1/5', '5/1', '1/4'],
      correctAnswer: '1/2',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'Which is larger: 1/3 or 1/4?',
      options: ['1/3', '1/4', 'They are equal', 'None of the options'],
      correctAnswer: '1/3',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'What is 2/5 + 1/5?',
      options: ['1/5', '2/10', '3/5', '3/10'],
      correctAnswer: '3/5',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'Which fraction is NOT equivalent to 3/9?',
      options: ['1/3', '2/6', '4/12', '2/9'],
      correctAnswer: '2/9',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'Express 0.25 as a fraction.',
      options: ['1/4', '1/25', '2/5', '25/100'],
      correctAnswer: '1/4',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'What is 3/8 - 1/8?',
      options: ['1/8', '2/8', '2/16', '4/8'],
      correctAnswer: '2/8',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'What decimal represents seventy-five hundredths?',
      options: ['0.075', '0.75', '7.5', '0.705'],
      correctAnswer: '0.75',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Fractions and Decimals',
      questionText: 'Which of these fractions is in simplest form?',
      options: ['2/4', '4/10', '3/7', '6/9'],
      correctAnswer: '3/7',
      difficulty: 'medium',
    },

    // --- Geometry and Measurements (10 questions) ---
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'A rectangle has 5cm length and 3cm width. What is its perimeter?',
      options: ['8cm', '15cm', '16cm', '30cm'],
      correctAnswer: '16cm',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'A rectangle has 5cm length and 3cm width. What is its area?',
      options: ['8cm²', '15cm²', '16cm²', '30cm²'],
      correctAnswer: '15cm²',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'How many centimeters are in 1 meter?',
      options: ['10 cm', '100 cm', '1000 cm', '1 cm'],
      correctAnswer: '100 cm',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'Which geometric figure has 3 sides?',
      options: ['Square', 'Circle', 'Triangle', 'Rectangle'],
      correctAnswer: 'Triangle',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'How many sides does a quadrilateral have?',
      options: ['3', '4', '5', '6'],
      correctAnswer: '4',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'What is the perimeter of a square with side length 7 cm?',
      options: ['14 cm', '21 cm', '28 cm', '49 cm'],
      correctAnswer: '28 cm',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'How many inches are in 2 feet?',
      options: ['12 inches', '18 inches', '24 inches', '36 inches'],
      correctAnswer: '24 inches',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'What is the measure of a right angle?',
      options: ['45 degrees', '90 degrees', '180 degrees', '360 degrees'],
      correctAnswer: '90 degrees',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'A square has an area of 25 cm². What is the length of each side?',
      options: ['4 cm', '5 cm', '12.5 cm', '50 cm'],
      correctAnswer: '5 cm',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Geometry and Measurements',
      questionText: 'How many millimeters are in 1 centimeter?',
      options: ['0.1 mm', '1 mm', '10 mm', '100 mm'],
      correctAnswer: '10 mm',
      difficulty: 'easy',
    },

    // --- Data and Probability (10 questions) ---
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'If you roll a 6-sided die, what is the probability of getting a 3?',
      options: ['1/6', '1/3', '3/6', '1/2'],
      correctAnswer: '1/6',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'In a bag with 4 red marbles, 3 blue marbles, and 3 green marbles, what is the probability of randomly selecting a blue marble?',
      options: ['3/10', '1/3', '4/10', '1/4'],
      correctAnswer: '3/10',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'What is more likely to happen?',
      options: [
        'Rolling a 7 on a die', 
        'Drawing a king from a deck of cards', 
        'Flipping a coin and getting heads', 
        'Rolling doubles on two dice'
      ],
      correctAnswer: 'Flipping a coin and getting heads',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'If a spinner has equal sections colored red, blue, green, and yellow, what is the probability of landing on blue?',
      options: ['1/2', '1/3', '1/4', '1/5'],
      correctAnswer: '1/4',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'In a standard deck of 52 cards, what is the probability of drawing a heart?',
      options: ['1/4', '1/13', '13/52', '1/2'],
      correctAnswer: '1/4',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'Monthly rainfall (in inches) for a city was: Jan - 2, Feb - 3, Mar - 5, Apr - 4. What was the average monthly rainfall?',
      options: ['2.5 inches', '3 inches', '3.5 inches', '4 inches'],
      correctAnswer: '3.5 inches',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'Which event is impossible?',
      options: [
        'Drawing a red card from a standard deck', 
        'Rolling a 1 on a die', 
        'Drawing a king of hearts from a standard deck', 
        'Rolling a 7 on a standard die'
      ],
      correctAnswer: 'Rolling a 7 on a standard die',
      difficulty: 'easy',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'Five students scored the following on a test: 85, 90, 95, 80, 90. What is the median score?',
      options: ['85', '88', '90', '95'],
      correctAnswer: '90',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'If you flip a coin twice, what is the probability of getting heads both times?',
      options: ['1/4', '1/3', '1/2', '3/4'],
      correctAnswer: '1/4',
      difficulty: 'medium',
    },
    {
      id: crypto.randomUUID(),
      topic: 'Data and Probability',
      questionText: 'Which of these is certain to happen?',
      options: [
        'It will rain tomorrow', 
        'Rolling an even number on a die', 
        'Drawing a card higher than 10 from a deck', 
        'Rolling a number less than 7 on a standard die'
      ],
      correctAnswer: 'Rolling a number less than 7 on a standard die',
      difficulty: 'medium',
    },
  ];

  getQuizQuestions(): QuestionDto[] {
    const shuffled = [...this.allQuestions].sort(() => 0.5 - Math.random());
    return shuffled.slice(0, 10);
  }
}
